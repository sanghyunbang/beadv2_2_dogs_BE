#!/bin/sh
#
# Pre-commit hook for Baro Farm project
# μ»¤λ°‹ μ „ μ½”λ“ ν’μ§ κ²€μ‚¬ μ‹¤ν–‰
#

echo "π” Pre-commit hook μ‹¤ν–‰ μ¤‘..."

# ν”„λ΅μ νΈ λ£¨νΈ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™
cd "$(git rev-parse --show-toplevel)" || exit 1

# 1. Spotless ν¬λ§· κ²€μ‚¬
echo ""
echo "π“ [1/2] Spotless ν¬λ§· κ²€μ‚¬..."
./gradlew spotlessCheck --no-daemon -q

if [ $? -ne 0 ]; then
    echo ""
    echo "β μ½”λ“ ν¬λ§·μ΄ λ§μ§€ μ•μµλ‹λ‹¤!"
    echo "π‘‰ λ‹¤μ λ…λ Ήμ–΄λ΅ μλ™ μμ •ν•μ„Έμ”: ./gradlew spotlessApply"
    echo ""
    exit 1
fi
echo "β… Spotless κ²€μ‚¬ ν†µκ³Ό"

# 2. Checkstyle κ²€μ‚¬
echo ""
echo "π” [2/2] Checkstyle κ²€μ‚¬..."
./gradlew checkstyleMain --no-daemon -q

if [ $? -ne 0 ]; then
    echo ""
    echo "β Checkstyle κ²€μ‚¬ μ‹¤ν¨!"
    echo "π‘‰ build/reports/checkstyle/ μ—μ„ μƒμ„Έ λ‚΄μ©μ„ ν™•μΈν•μ„Έμ”."
    echo ""
    exit 1
fi
echo "β… Checkstyle κ²€μ‚¬ ν†µκ³Ό"

echo ""
echo "π‰ λ¨λ“  κ²€μ‚¬ ν†µκ³Ό! μ»¤λ°‹μ„ μ§„ν–‰ν•©λ‹λ‹¤."
exit 0

